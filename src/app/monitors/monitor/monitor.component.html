<div class="container" *ngIf="monitor">
  <div class="heading">
    <hydro-headline>{{ monitor.name }}</hydro-headline>
  </div>
  <div class="inner-wrapper">
    <div class="details">
      <p>{{ monitor.description }}</p>
      <p *ngIf="dataType">
        You are currently viewing {{ dataType }} data
        <span *ngIf="timeLiveDataReceived">
          received at {{ timeLiveDataReceived | date: 'HH:mm:ss dd/MM/yyyy' }}
        </span>
      </p>
    </div>

    <div class="buttons">
      <hydro-button-raised
        color="primary"
        (click)="togglePause()"
        [disabled]="!(liveData && liveData.length)"
        class="button"
      >
        <mat-icon class="icon">{{ paused ? 'play_arrow' : 'pause' }}</mat-icon>
        {{ paused ? 'Run' : 'Pause' }}
      </hydro-button-raised>

      <hydro-button-raised color="accent" (click)="showEpl()" class="button">
        <mat-icon class="icon">image_search</mat-icon>
        Show Epl Query
      </hydro-button-raised>

      <hydro-button-raised
        (click)="router.navigateByUrl(editLink)"
        class="button"
      >
        <mat-icon class="icon">edit</mat-icon>
        Edit Monitor
      </hydro-button-raised>
    </div>
  </div>

  <div
    class="table-outer-wrapper"
    [ngClass]="{ 'table-outer-wrapper': dataSource && dataSource.data.length }"
  >
    <div
      class="table-inner-wrapper"
      *ngIf="dataSource && dataSource.data.length; else noData"
    >
      <table
        mat-table
        matSort
        [dataSource]="dataSource"
        (matSortChange)="sortData($event)"
        class="table"
      >
        <ng-container
          *ngFor="let column of displayedColumns"
          matColumnDef="{{ column }}"
        >
          <th
            mat-header-cell
            *matHeaderCellDef
            mat-sort-header
            class="header-name"
          >
            {{ column }}
          </th>
          <td mat-cell *matCellDef="let element">
            {{
              headersMetadata[column].type === monitorDataAttributeType.DateTime
                ? (element[column] | date: headersMetadata[column].format)
                : element[column] || '-'
            }}
          </td>
        </ng-container>

        <tr
          mat-header-row
          *matHeaderRowDef="displayedColumns; sticky: true"
        ></tr>
        <tr mat-row *matRowDef="let row; columns: displayedColumns"></tr>
      </table>
    </div>
  </div>
</div>

<ng-template #noData>
  <section class="messages">
    <mat-card class="example-card">
      <mat-card-header>
        <mat-card-title>Messages</mat-card-title>
      </mat-card-header>
      <mat-card-content>
        <p>{{ cachedDataMessage }}</p>
        <p>{{ liveDataMessage }}</p>
        <mat-progress-bar mode="indeterminate"></mat-progress-bar>
      </mat-card-content>
    </mat-card>
  </section>
</ng-template>
